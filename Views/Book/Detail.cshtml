@using Microsoft.AspNetCore.Identity
@model BookDetail
@inject UserManager<ApplicationUser> _userManager;

@{
    ViewBag.Title = "title";
    Layout = "_Layout";
}

@*
<h1>Details</h1>

<div>
    <hr />
    <dl class="row">
        <img src="@Model.Book.Image" class="card-img-top" alt="Book">
        <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.Book.Title)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Book.Title)
        </dd>
        <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.Book.Author)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Book.Author)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Book.Category.Name)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Book.Category.Name)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Book.Summary)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Book.Summary)
        </dd>        
        <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.Book.Price)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Book.Price)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Book.UpdateDate)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Book.UpdateDate)
        </dd>        
    </dl>
</div>
<div>
    <a asp-action="Update" asp-route-id="@Model?.Book.Id">Update</a> |
    <a asp-action="Index">Back to List</a>
</div>*@

<div class="container">
  <div
    class="text-start"
    data-reflow-type="product"
    data-reflow-product="1836211702"
    data-reflow-shoppingcart-url="cart.html"
  >
    <div class="reflow-product">
      <div class="ref-media">
        <div class="ref-preview">
          <img
            class="ref-image active"
            src="@Model.Book.Image"
            data-reflow-preview-type="image"
          />
        </div>
      </div>
      <div class="ref-product-data">
        <h2 class="ref-name">@Model.Book.Title</h2>
        <div class="ref-categories">
          <span class="ref-category">@Model.Book.Category.Name</span>
        </div>
        <strong class="ref-price">$@Model.Book.Price</strong
        ><span
             data-reflow-type="add-to-cart"
             data-reflow-shoppingcart-url="cart.html"
             data-reflow-addtocart-text=""
             data-reflow-product="1836211702"
         ><div class="reflow-add-to-cart ref-product-controls">
                  <span
                      data-reflow-product="1836211702"
                      data-reflow-max-qty="999"
                      data-reflow-quantity="1">
                  </span>
                  @{
                      var userId = _userManager.GetUserId(User);
                      if (User.IsInRole(Role.Owner))
                      {
                          @Html.ActionLink("Update", "Update", "Book", new
                          {
                              id = Model.Book.Id
                          }, new
                          {
                              @class = "ref-button preview-toggle"
                          })
                          @Html.ActionLink("Delete", "Delete", "Book", new
                          {
                              id = Model.Book.Id,
                          }, new
                          {
                              @class = "ref-button preview-toggle"
                          })
                      }
                      else if (User.IsInRole(Role.Customer))
                      {
                          @Html.ActionLink("Add to Cart", "Create", "OrderedBook", new
                          {
                              bookId = Model.Book.Id,
                              userId,
                          }, new
                          {
                              @class = "ref-button"
                          })
                      }
                  }
              </div>
          </span>
          <div class="ref-description">
          <p>@Model.Book.Summary</p>
        </div>
      </div>
    </div>
  </div>
</div>